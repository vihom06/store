<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Welcome - Vikram Store</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://cdn.jsdelivr.net/npm/daisyui@4.4.20/dist/full.css" rel="stylesheet" type="text/css" />
</head>
<body class="bg-gradient-to-r from-pink-400 via-purple-500 to-indigo-500 text-white min-h-screen flex items-center justify-center flex-col text-center">

  <h1 class="text-4xl md:text-5xl font-bold mb-4">Welcome to Vikram Store ðŸ›’</h1>
  <p class="mb-8 text-lg md:text-xl">Your colorful one-stop grocery solution</p>
  <button onclick="showLogin()" class="bg-white text-purple-700 font-bold py-3 px-6 rounded-full hover:scale-105 transition">Continue Shopping</button>

  <!-- Login Modal -->
  <div id="loginModal" class="fixed inset-0 hidden bg-black bg-opacity-50 items-center justify-center z-50">
    <div class="bg-white text-black rounded-lg shadow-lg p-8 w-full max-w-sm">
      <h2 class="text-xl font-bold mb-4">Login to Shop</h2>
      <input id="username" type="text" placeholder="Username" class="input input-bordered w-full mb-3" />
      <input id="password" type="password" placeholder="Password" class="input input-bordered w-full mb-4" />
      <button onclick="login()" class="btn btn-primary w-full">Login</button>
    </div>
  </div>

  <!-- Cookie Consent Banner -->
  <div id="cookieConsent" class="fixed bottom-0 left-0 w-full bg-white text-black p-4 text-center shadow-md">
    This site uses cookies for better shopping. <button onclick="acceptCookies()" class="btn btn-sm btn-primary ml-2">Accept</button>
  </div>

  <script>
    function showLogin() {
      document.getElementById('loginModal').style.display = 'flex';
    }

    function acceptCookies() {
      document.cookie = "cookieConsent=true; max-age=31536000; path=/";
      document.getElementById('cookieConsent').style.display = 'none';
    }

    function getCookie(name) {
      const match = document.cookie.match(new RegExp('(^| )' + name + '=([^;]+)'));
      return match ? match[2] : null;
    }

    window.onload = function () {
      if (getCookie('cookieConsent') === 'true') {
        document.getElementById('cookieConsent').style.display = 'none';
      }
    }

    // Fixed login function - set key that shop page expects
    function login() {
      const uname = document.getElementById('username').value.trim();
      const pass = document.getElementById('password').value.trim();

      if (!uname || !pass) {
        alert('Please enter username and password.');
        return;
      }

      // Get users list or empty
      const users = JSON.parse(localStorage.getItem('vikram_store_users') || '[]');

      // Check if user exists, if not add with FIFO logic
      if (!users.find(u => u.username === uname)) {
        if (users.length >= 5) users.shift(); // remove oldest user
        users.push({ username: uname, password: pass });
        localStorage.setItem('vikram_store_users', JSON.stringify(users));
      }

      // Save logged in user with the key shop.js expects
      localStorage.setItem('vikram_store_logged_in', uname);
      alert('Login successful!');
      window.location.href = 'shop.html';
    }
  </script>
</body>
</html>
